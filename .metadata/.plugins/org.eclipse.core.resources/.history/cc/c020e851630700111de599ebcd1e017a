package StepDefinitions;

import java.io.File;
import java.io.IOException;
import java.util.Map;

import org.apache.pdfbox.pdmodel.PDDocument;
import org.testng.Assert;

import TestSetup.CustomPDFStripper;
import io.cucumber.java.en.Given;
import io.cucumber.java.en.Then;
import io.cucumber.java.en.When;

public class PDFStepDefinitions {
    PDDocument document;
    
    @Given("user has the PDF file {string}")
    public void loadPDF(String fileName) throws IOException {
        document = PDDocument.load(new File("src/test/resources/" + fileName)); // Load PDF
    }

    @When("user validates all pages of the PDF")
    public void validateDetails() throws IOException {
        int pageCount = document.getNumberOfPages(); // Get page count
        for (int i = 1; i <= pageCount; i++) {
            CustomPDFStripper stripper = new CustomPDFStripper();
            stripper.setStartPage(i);
            stripper.setEndPage(i);
            String pageText = stripper.getText(document);
            // logic to compare pageText with Excel row 'i'
        }
   }
    
//    @Then("the PDF content on page {int} should match the test data")
//    public void validatePdfContent(int pageNum) throws IOException {
//        // 1. Get Actual PDF Details
//        PDFValidator stripper = new PDFValidator();
//        stripper.setStartPage(pageNum);
//        stripper.setEndPage(pageNum);
//        String actualText = stripper.getText(document);
//        
//        // 2. Get Expected Excel Details
//        Map<String, String> expected = getExpectedData(pageNum);
//        
//        // 3. Assertions
//        Assert.assertTrue("Text Mismatch!", actualText.contains(expected.get("text")));
//        Assert.assertEquals("Font Mismatch!", expected.get("font"), stripper.lastFont);
//        // Add color assertion as needed
//    }

    
    
}



